name: Build
description: Build Linux (Singularity) Images

runs:
  using: "composite"
  steps:

  - name: Install singularity
    uses: eWaterCycle/setup-singularity@v7
    with:
      singularity-version: 3.8.3

  - name: Build Singularity Image
    shell: bash
    run: |
      cd scripts/linux
      sudo ${SINGULARITY_ROOT}/bin/singularity build jv2-build.sif ./jv2-build.def
      sudo ${SINGULARITY_ROOT}/bin/singularity build jv2.sif ./jv2.def

  - name: Upload Artifact
    uses: actions/upload-artifact@v3
    with:
      name: Packages
      path: scripts/linux/jv2.sif
      if-no-files-found: error
